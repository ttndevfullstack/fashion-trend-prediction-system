<!DOCTYPE html>
<html lang="en">
<head>
<title>Page Title</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://d3js.org/d3.v3.min.js"></script>



<style>

* {
  box-sizing: border-box;
}

/* Style the body */
body {
  font-family: Arial, Helvetica, sans-serif;
  margin: 0;
}

/* Header/logo Title */
.header {
  padding: 80px;
  text-align: center;
  background-image: url("./static/img/unicorn6.png"); 
  color: Black;
  
  
}

/* Increase the font size of the heading */
.header h1 {
  font-size: 40px;
}

/* Style the top navigation bar */
.navbar {
  overflow: hidden;
  background-color: #333;
}

/* Style the navigation bar links */
.navbar a {
  float: left;
  display: block;
  color: white;
  text-align: center;
  padding: 14px 20px;
  text-decoration: none;
}

/* Right-aligned link */
.navbar a.right {
  float: right;
}

/* Change color on hover */
.navbar a:hover {
  background-color: #ddd;
  color: black;
}

/* Column container */
.row {  
  display: -ms-flexbox; /* IE10 */
  display: flex;
  -ms-flex-wrap: wrap; /* IE10 */
  flex-wrap: wrap;
}


/* Main column */
.main {   
  -ms-flex: 100%; /* IE10 */
  flex: 100%;
  background-color: #d2e4e4;
  padding: 20px;
}


/* Footer */
.footer {
-ms-flex: 100%; /* IE10 */
  flex: 100%;
  padding: 20px;
  text-align: center;
  background: #dbe4d2;
}

/* Responsive layout - when the screen is less than 700px wide, make the two columns stack on top of each other instead of next to each other */
@media screen and (max-width: 700px) {
  .row {   
    flex-direction: column;
  }
}

/* Responsive layout - when the screen is less than 400px wide, make the navigation links stack on top of each other instead of next to each other */
@media screen and (max-width: 400px) {
  .navbar a {
    float: none;
    width: 100%;
  }
}



body {
  font-family: Arial, Helvetica, sans-serif;
  margin: 0;
}

html {
  box-sizing: border-box;
}

*, *:before, *:after {
  box-sizing: inherit;
}

.column {
  float: left;
  width: 20%;
  margin-bottom: 16px;
  padding: 0 8px;
}

.columngraph {
margin:auto;
  width: 80%;
  margin-bottom: auto;
  padding: 0 8px;
}

.card {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
  margin: 8px;
  background-color: white;
}

.about-section {
  padding: 50px;
  text-align: center;
  background-color: #e4d2d2;
  color: white;
}

.container {
  padding: 0 16px;
}

.container::after, .row::after {
  content: "";
  clear: both;
  display: table;
}

.title {
  color: grey;
}

.descgraph {
  color: grey;
  font: 15px sans-serif;
  text-align:center;
  
}

@media screen and (max-width: 650px) {
  .column {
    width: 100%;
    display: block;
  }
}

.centerimg {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
  padding: 10px;
}
.maingraph {   
  -ms-flex: 100%; /* IE10 */
  flex: 100%;
  background-color: white;
  height: 650px;
  padding: 20px;
  margin-left: auto;
  margin-right: auto;
  width: 100%;
}





text {
  font: 10px sans-serif;
}

button{
  font: 10px sans-serif;
    
}

rect.background {
  fill: white;
  stroke: #646464;
  stroke-width: 1px;
  stroke-dasharray: 2,2;
  stroke-linejoin: round;
}

.axis {
  shape-rendering: crispEdges;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
}

.left-div {
  float:left;
  height: 550px;
  width: 820px;
  
}

</style>

<body>
    	<div class="header">
          <h1>Fashion trend prediction system</h1>
        </div>
        
        <div class="navbar">
          <a href="home?">Home</a>
          <a href="aboutus?">About Us</a>
           
          <a href="contactus?" class="right">Contact Us</a>
        </div>
        
        <div class="main">
            <h2 style="text-align:center">CURRENT TRENDS LEADERBOARD</h2>
            <div class="row" style="align:center">
              <div class="column">
                <div class="card">
                  <img src={{ images_path[0] }} alt="TOPTREND1" class="centerimg">
                  <div class="container">
                    <h2>TOP TREND #1</h2>
                    <p class="title">{{ top1_name[0] }}</p>
                    <a href={{ top1_description[0] }}>Link</a>
                    <p> Score: {{ top1_score[0] }} </p>
                  </div>
                </div>
              </div>
            
              <div class="column">
                <div class="card">
                  <img src={{ images_path[1] }} alt="TOPTREND2" class="centerimg">
                  <div class="container">
                    <h2>TOP TREND #2</h2>
                    <p class="title">{{ top1_name[1] }}</p>
                    <a href={{ top1_description[1] }}>Link</a>
                    <p> Score: {{ top1_score[1] }} </p>
                  </div>
                </div>
              </div>
            
            <div class="column">
                <div class="card">
                  <img src={{ images_path[2] }} alt="TOPTREND3" class="centerimg">
                  <div class="container">
                    <h2>TOP TREND #3</h2>
                    <p class="title">{{ top1_name[2] }}</p>
                    <a href={{ top1_description[2] }}>Link</a>
                    <p> Score: {{ top1_score[2] }} </p>
                  </div>
                </div>
              </div>
            
              <div class="column">
                <div class="card">
                  <img src={{ images_path[3] }} alt="TOPTREND4" class="centerimg">
                  <div class="container">
                    <h2>TOP TREND #4</h2>
                    <p class="title">{{ top1_name[3] }}</p>
                    <a href={{ top1_description[3] }}>Link</a>
                    <p> Score: {{ top1_score[3] }} </p>
                  </div>
                </div>
              </div>
            
              <div class="column">
                <div class="card">
                  <img src={{ images_path[4] }} alt="TOPTREND5" class="centerimg">
                  <div class="container">
                    <h2>TOP TREND #5</h2>
                    <p class="title">{{ top1_name[4] }}</p>
                    <a href={{ top1_description[4] }}>Link</a>
                    <p> Score: {{ top1_score[4] }} </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="row" style="align:center">
              <div class="column">
                <div class="card">
                  <img src={{ images_path[5] }} alt="BOTTOMTREND1" class="centerimg">
                  <div class="container">
                    <h2>BOTTOM TREND #1</h2>
                    <p class="title">{{ bottom1_name[0] }}</p>
                    <a href={{ bottom1_description[0] }}>Link</a>
                    <p> Score: {{ bottom1_score[0] }} </p>
                  </div>
                </div>
              </div>
            
              <div class="column">
                <div class="card">
                  <img src={{ images_path[6] }} alt="BOTTOMTREND2" class="centerimg">
                  <div class="container">
                    <h2>BOTTOM TREND #2</h2>
                    <p class="title">{{ bottom1_name[1] }}</p>
                    <a href={{ bottom1_description[1] }}>Link</a>
                    <p> Score: {{ bottom1_score[1] }} </p>
                  </div>
                </div>
              </div>
            
              <div class="column">
                <div class="card">
                  <img src={{ images_path[7] }} alt="BOTTOMTREND3" class="centerimg">
                  <div class="container">
                    <h2>BOTTOM TREND #3</h2>
                    <p class="title">{{ bottom1_name[2] }}</p>
                    <a href={{ bottom1_description[2] }}>Link</a>
                    <p> Score: {{ bottom1_score[2] }} </p>
                  </div>
                </div>
              </div>
              
              <div class="column">
                <div class="card">
                  <img src={{ images_path[8] }} alt="BOTTOMTREND4" class="centerimg">
                  <div class="container">
                    <h2>BOTTOM TREND #4</h2>
                    <p class="title">{{ bottom1_name[3] }}</p>
                    <a href={{ bottom1_description[3] }}>Link</a>
                    <p> Score: {{ bottom1_score[3] }} </p>
                  </div>
                </div>
              </div>
            
              <div class="column">
                <div class="card">
                  <img src={{ images_path[9] }} alt="BOTTOMTREND5" class="centerimg">
                  <div class="container">
                    <h2>BOTTOM TREND #5</h2>
                    <p class="title">{{ bottom1_name[4] }}</p>
                    <a href={{ bottom1_description[4] }}>Link</a>
                    <p> Score: {{ bottom1_score[4] }} </p>
                  </div>
                </div>
              </div>
            </div>
        </div>
        




</body>


<body>

<div class="main" id="graphDiv1" >  
<div class="row" style="align:center">
<div class="columngraph">
<div class="card" >
<div class="maingraph" id="graphDiv" style="align:center;">
<h2 style="text-align:center">CURRENT TRENDS : COLOUR</h2>
<p class="descgraph">Click on the name/bar to see its details.</p>
<p class="descgraph">Click anywhere inside the box to return to the previous graph.</p>
<p class="descgraph">This bar graph represents the top 5 and bottom 5 bigrams along with their rating range.</p>
<br>
</div>
<br>
</div>
</div>

<div class="columngraph">
<div class="card" >
<div class="maingraph" id="graphDiv2" style="align:center;">
<h2 style="text-align:center">CURRENT TRENDS : NECK PATTERN</h2>
<p class="descgraph">Click on the name/bar to see its details.</p>
<p class="descgraph">Click anywhere inside the box to return to the previous graph.</p>
<p class="descgraph">This bar graph represents the top 5 and bottom 5 bigrams along with their rating range.</p>
<br>
</div>
<br>
</div>
</div>

<div class="columngraph">
<div class="card" >
<div class="maingraph" id="graphDiv3" style="align:center;">
<h2 style="text-align:center">CURRENT TRENDS : PRINT</h2>
<p class="descgraph">Click on the name/bar to see its details.</p>
<p class="descgraph">Click anywhere inside the box to return to the previous graph.</p>
<p class="descgraph">This bar graph represents the top 5 and bottom 5 bigrams along with their rating range.</p>
<br>
</div>
<br>
</div>
</div>

</div>
</div>
</div>



    
<script >
(function svg1(){
    var margin = {top: 20, right: 40, bottom: 0, left: 200},
    width = 900 - margin.left - margin.right,
    height = 390 - margin.top - margin.bottom;

var x = d3.scale.linear()
    .range([0, width]);
    

var barHeight = 20;

var color = d3.scale.ordinal()
    .range([ "#5b9797", "#a2c7c7" ]);

var duration = 200,
    delay = 80;

var partition = d3.layout.partition()
    .value(function(d) { return d.size; });

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("top");
//kbn
var svg1 = d3.select("#graphDiv").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
//kbn
svg1.append("rect")
    .attr("class", "background")
    .attr("fill", "#e2eeee")
    .attr("width", width)
    .attr("height", height)
    .on("click", up);
    
//kbn
svg1.append("button")
    .attr("x", 2)
    .attr("y", 300)
    .text("Click here")
    .style("font-size", "15px")
    .on("click", up);
//kbn
svg1.append("g")
    .attr("class", "x axis");
//kbn
svg1.append("g")
    .attr("class", "y axis")
  .append("line")
    .attr("y1", "100%")


d3.json("/currenttrendsget-data", function(error, root) {
  //if (error) throw error;
  
  partition.nodes(root);
  x.domain([0, root.value]).nice();
  down(root, 0);
});

function down(d, i) {
  if (!d.children || this.__transition__) return;
  var end = duration + d.children.length * delay;

  // Mark any currently-displayed bars as exiting.
  //kbn
  var exit = svg1.selectAll(".enter")
      .attr("class", "exit");

  // Entering nodes immediately obscure the clicked-on bar, so hide it.
  exit.selectAll("rect").filter(function(p) { return p === d; })
      .style("fill-opacity", 1e-6);

  // Enter the new bars for the clicked-on data.
  // Per above, entering bars are immediately visible.
  var enter = bar(d)
      .attr("transform", stack(i))
      .style("opacity", 1)
      .style("font-size", "15px");

  // Have the text fade-in, even though the bars are visible.
  // Color the bars as parents; they will fade to children if appropriate.
  enter.select("text").style("fill-opacity", 1e-6);
  enter.select("rect").style("fill", color(true));

  // Update the x-scale domain.
  x.domain([0, d3.max(d.children, function(d) { return d.value; })]).nice();

  // Update the x-axis.
  //kbn
  svg1.selectAll(".x.axis").transition()
      .duration(duration)
      .style("font-size", "15px")
      .call(xAxis);

  // Transition entering bars to their new position.
  var enterTransition = enter.transition()
      .duration(duration)
      .delay(function(d, i) { return i * delay; })
      .attr("transform", function(d, i) { return "translate(0," + barHeight * i * 1.2 + ")"; });

  // Transition entering text.
  enterTransition.select("text")
      .style("fill-opacity", 1)
      .style("font-size", "15px");

  // Transition entering rects to the new x-scale.
  enterTransition.select("rect")
      .attr("width", function(d) { return x(d.value); })
      .style("fill", function(d) { return color(!!d.children); });


  // Transition exiting bars to fade out.
  var exitTransition = exit.transition()
      .duration(duration)
      .style("opacity", 1e-6)
      .remove();

  // Transition exiting bars to the new x-scale.
  exitTransition.selectAll("rect")
      .attr("width", function(d) { return x(d.value); });

  // Rebind the current node to the background.
  //kbn
  svg1.select(".background")
      .datum(d)
    .transition()
      .duration(end);

  d.index = i;
}

function up(d) {
  if (!d.parent || this.__transition__) return;
  var end = duration + d.children.length * delay;

  // Mark any currently-displayed bars as exiting.
  //kbn
  var exit = svg1.selectAll(".enter")
      .attr("class", "exit");

  // Enter the new bars for the clicked-on data's parent.
  var enter = bar(d.parent)
      .attr("transform", function(d, i) { return "translate(0," + barHeight * i * 1.2 + ")"; })
      .style("opacity", 1e-6);

  // Color the bars as appropriate.
  // Exiting nodes will obscure the parent bar, so hide it.
  enter.select("rect")
      .style("fill", function(d) { return color(!!d.children); })
    .filter(function(p) { return p === d; })
      .style("fill-opacity", 1e-6);

  // Update the x-scale domain.
  x.domain([0, d3.max(d.parent.children, function(d) { return d.value; })]).nice();

  // Update the x-axis.
  //kbn
  svg1.selectAll(".x.axis").transition()
      .duration(duration)
      .style("font-size", "15px")
      .call(xAxis);

  // Transition entering bars to fade in over the full duration.
  var enterTransition = enter.transition()
      .duration(end)
      .style("opacity", 1);

  // Transition entering rects to the new x-scale.
  // When the entering parent rect is done, make it visible!
  enterTransition.select("rect")
      .attr("width", function(d) { return x(d.value); })
      .each("end", function(p) { if (p === d) d3.select(this).style("fill-opacity", null); });

  // Transition exiting bars to the parent's position.
  var exitTransition = exit.selectAll("g").transition()
      .duration(duration)
      .delay(function(d, i) { return i * delay; })
      .attr("transform", stack(d.index));

  // Transition exiting text to fade out.
  exitTransition.select("text")
      .style("fill-opacity", 1e-6)
      .style("font-size", "15px");

  // Transition exiting rects to the new scale and fade to parent color.
  exitTransition.select("rect")
      .attr("width", function(d) { return x(d.value); })
      .style("fill", color(true));

  // Remove exiting nodes when the last child has finished transitioning.
  exit.transition()
      .duration(end)
      .remove();

  // Rebind the current parent to the background.
  //kbn
  svg1.select(".background")
      .datum(d.parent)
    .transition()
      .duration(end);
}

// Creates a set of bars for the given data node, at the specified index.
function bar(d) {
  //kbn
  var bar = svg1.insert("g", ".y.axis")
      .attr("class", "enter")
      .attr("transform", "translate(0,5)")
    .selectAll("g")
      .data(d.children)
      .style("font-size", "15px")
    .enter().append("g")
      .style("cursor", function(d) { return !d.children ? null : "pointer"; })
      .on("click", down);

  bar.append("text")
      .attr("x", -6)
      .attr("y", barHeight / 2)
      .attr("dy", ".35em")
      .style("text-anchor", "end")
      .style("font-size", "15px")
      .text(function(d) { return d.name; });

  bar.append("rect")
      .attr("width", function(d) { return x(d.value); })
      .attr("height", barHeight)
      .style("font-size", "15px");

  return bar;
}

// A stateful closure for stacking bars horizontally.
function stack(i) {
  var x0 = 0;
  return function(d) {
    var tx = "translate(" + x0 + "," + barHeight * i * 1.2 + ")";
    x0 += x(d.value);
    return tx;
  };
}})()


</script>
<script>

(function svg2(){
    var margin = {top: 20, right: 40, bottom: 0, left: 200},
    width = 900 - margin.left - margin.right,
    height = 390 - margin.top - margin.bottom;

var x = d3.scale.linear()
    .range([0, width]);
    

var barHeight = 20;

var color = d3.scale.ordinal()
    .range([ "#5b9797", "#a2c7c7" ]);

var duration = 200,
    delay = 80;

var partition = d3.layout.partition()
    .value(function(d) { return d.size; });

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("top");
//kbn
var svg1 = d3.select("#graphDiv2").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
//kbn
svg1.append("rect")
    .attr("class", "background")
    .attr("fill", "#e2eeee")
    .attr("width", width)
    .attr("height", height)
    .on("click", up);
    
//kbn
svg1.append("button")
    .attr("x", 2)
    .attr("y", 300)
    .text("Click here")
    .style("font-size", "15px")
    .on("click", up);
//kbn
svg1.append("g")
    .attr("class", "x axis");
//kbn
svg1.append("g")
    .attr("class", "y axis")
  .append("line")
    .attr("y1", "100%")


d3.json("/currenttrendsgetdata2", function(error, root) {
  //if (error) throw error;
  
  partition.nodes(root);
  x.domain([0, root.value]).nice();
  down(root, 0);
});

function down(d, i) {
  if (!d.children || this.__transition__) return;
  var end = duration + d.children.length * delay;

  // Mark any currently-displayed bars as exiting.
  //kbn
  var exit = svg1.selectAll(".enter")
      .attr("class", "exit");

  // Entering nodes immediately obscure the clicked-on bar, so hide it.
  exit.selectAll("rect").filter(function(p) { return p === d; })
      .style("fill-opacity", 1e-6);

  // Enter the new bars for the clicked-on data.
  // Per above, entering bars are immediately visible.
  var enter = bar(d)
      .attr("transform", stack(i))
      .style("opacity", 1)
      .style("font-size", "15px");

  // Have the text fade-in, even though the bars are visible.
  // Color the bars as parents; they will fade to children if appropriate.
  enter.select("text").style("fill-opacity", 1e-6);
  enter.select("rect").style("fill", color(true));

  // Update the x-scale domain.
  x.domain([0, d3.max(d.children, function(d) { return d.value; })]).nice();

  // Update the x-axis.
  //kbn
  svg1.selectAll(".x.axis").transition()
      .duration(duration)
      .style("font-size", "15px")
      .call(xAxis);

  // Transition entering bars to their new position.
  var enterTransition = enter.transition()
      .duration(duration)
      .delay(function(d, i) { return i * delay; })
      .attr("transform", function(d, i) { return "translate(0," + barHeight * i * 1.2 + ")"; });

  // Transition entering text.
  enterTransition.select("text")
      .style("fill-opacity", 1)
      .style("font-size", "15px");

  // Transition entering rects to the new x-scale.
  enterTransition.select("rect")
      .attr("width", function(d) { return x(d.value); })
      .style("fill", function(d) { return color(!!d.children); });


  // Transition exiting bars to fade out.
  var exitTransition = exit.transition()
      .duration(duration)
      .style("opacity", 1e-6)
      .remove();

  // Transition exiting bars to the new x-scale.
  exitTransition.selectAll("rect")
      .attr("width", function(d) { return x(d.value); });

  // Rebind the current node to the background.
  //kbn
  svg1.select(".background")
      .datum(d)
    .transition()
      .duration(end);

  d.index = i;
}

function up(d) {
  if (!d.parent || this.__transition__) return;
  var end = duration + d.children.length * delay;

  // Mark any currently-displayed bars as exiting.
  //kbn
  var exit = svg1.selectAll(".enter")
      .attr("class", "exit");

  // Enter the new bars for the clicked-on data's parent.
  var enter = bar(d.parent)
      .attr("transform", function(d, i) { return "translate(0," + barHeight * i * 1.2 + ")"; })
      .style("opacity", 1e-6);

  // Color the bars as appropriate.
  // Exiting nodes will obscure the parent bar, so hide it.
  enter.select("rect")
      .style("fill", function(d) { return color(!!d.children); })
    .filter(function(p) { return p === d; })
      .style("fill-opacity", 1e-6);

  // Update the x-scale domain.
  x.domain([0, d3.max(d.parent.children, function(d) { return d.value; })]).nice();

  // Update the x-axis.
  //kbn
  svg1.selectAll(".x.axis").transition()
      .duration(duration)
      .style("font-size", "15px")
      .call(xAxis);

  // Transition entering bars to fade in over the full duration.
  var enterTransition = enter.transition()
      .duration(end)
      .style("opacity", 1);

  // Transition entering rects to the new x-scale.
  // When the entering parent rect is done, make it visible!
  enterTransition.select("rect")
      .attr("width", function(d) { return x(d.value); })
      .each("end", function(p) { if (p === d) d3.select(this).style("fill-opacity", null); });

  // Transition exiting bars to the parent's position.
  var exitTransition = exit.selectAll("g").transition()
      .duration(duration)
      .delay(function(d, i) { return i * delay; })
      .attr("transform", stack(d.index));

  // Transition exiting text to fade out.
  exitTransition.select("text")
      .style("fill-opacity", 1e-6)
      .style("font-size", "15px");

  // Transition exiting rects to the new scale and fade to parent color.
  exitTransition.select("rect")
      .attr("width", function(d) { return x(d.value); })
      .style("fill", color(true));

  // Remove exiting nodes when the last child has finished transitioning.
  exit.transition()
      .duration(end)
      .remove();

  // Rebind the current parent to the background.
  //kbn
  svg1.select(".background")
      .datum(d.parent)
    .transition()
      .duration(end);
}

// Creates a set of bars for the given data node, at the specified index.
function bar(d) {
  //kbn
  var bar = svg1.insert("g", ".y.axis")
      .attr("class", "enter")
      .attr("transform", "translate(0,5)")
    .selectAll("g")
      .data(d.children)
      .style("font-size", "15px")
    .enter().append("g")
      .style("cursor", function(d) { return !d.children ? null : "pointer"; })
      .on("click", down);

  bar.append("text")
      .attr("x", -6)
      .attr("y", barHeight / 2)
      .attr("dy", ".35em")
      .style("text-anchor", "end")
      .style("font-size", "15px")
      .text(function(d) { return d.name; });

  bar.append("rect")
      .attr("width", function(d) { return x(d.value); })
      .attr("height", barHeight)
      .style("font-size", "15px");

  return bar;
}

// A stateful closure for stacking bars horizontally.
function stack(i) {
  var x0 = 0;
  return function(d) {
    var tx = "translate(" + x0 + "," + barHeight * i * 1.2 + ")";
    x0 += x(d.value);
    return tx;
  };
}})()
   
   
</script>
<script>
      
(function svg3(){
    var margin = {top: 20, right: 40, bottom: 0, left: 200},
    width = 900 - margin.left - margin.right,
    height = 390 - margin.top - margin.bottom;

var x = d3.scale.linear()
    .range([0, width]);
    

var barHeight = 20;

var color = d3.scale.ordinal()
    .range([ "#5b9797", "#a2c7c7" ]);

var duration = 200,
    delay = 80;

var partition = d3.layout.partition()
    .value(function(d) { return d.size; });

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("top");
//kbn
var svg1 = d3.select("#graphDiv3").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
//kbn
svg1.append("rect")
    .attr("class", "background")
    .attr("fill", "#e2eeee")
    .attr("width", width)
    .attr("height", height)
    .on("click", up);
    
//kbn
svg1.append("button")
    .attr("x", 2)
    .attr("y", 300)
    .text("Click here")
    .style("font-size", "15px")
    .on("click", up);
//kbn
svg1.append("g")
    .attr("class", "x axis");
//kbn
svg1.append("g")
    .attr("class", "y axis")
  .append("line")
    .attr("y1", "100%")


d3.json("/currenttrendsgetdata3", function(error, root) {
  //if (error) throw error;
  
  partition.nodes(root);
  x.domain([0, root.value]).nice();
  down(root, 0);
});

function down(d, i) {
  if (!d.children || this.__transition__) return;
  var end = duration + d.children.length * delay;

  // Mark any currently-displayed bars as exiting.
  //kbn
  var exit = svg1.selectAll(".enter")
      .attr("class", "exit");

  // Entering nodes immediately obscure the clicked-on bar, so hide it.
  exit.selectAll("rect").filter(function(p) { return p === d; })
      .style("fill-opacity", 1e-6);

  // Enter the new bars for the clicked-on data.
  // Per above, entering bars are immediately visible.
  var enter = bar(d)
      .attr("transform", stack(i))
      .style("opacity", 1)
      .style("font-size", "15px");

  // Have the text fade-in, even though the bars are visible.
  // Color the bars as parents; they will fade to children if appropriate.
  enter.select("text").style("fill-opacity", 1e-6);
  enter.select("rect").style("fill", color(true));

  // Update the x-scale domain.
  x.domain([0, d3.max(d.children, function(d) { return d.value; })]).nice();

  // Update the x-axis.
  //kbn
  svg1.selectAll(".x.axis").transition()
      .duration(duration)
      .style("font-size", "15px")
      .call(xAxis);

  // Transition entering bars to their new position.
  var enterTransition = enter.transition()
      .duration(duration)
      .delay(function(d, i) { return i * delay; })
      .attr("transform", function(d, i) { return "translate(0," + barHeight * i * 1.2 + ")"; });

  // Transition entering text.
  enterTransition.select("text")
      .style("fill-opacity", 1)
      .style("font-size", "15px");

  // Transition entering rects to the new x-scale.
  enterTransition.select("rect")
      .attr("width", function(d) { return x(d.value); })
      .style("fill", function(d) { return color(!!d.children); });


  // Transition exiting bars to fade out.
  var exitTransition = exit.transition()
      .duration(duration)
      .style("opacity", 1e-6)
      .remove();

  // Transition exiting bars to the new x-scale.
  exitTransition.selectAll("rect")
      .attr("width", function(d) { return x(d.value); });

  // Rebind the current node to the background.
  //kbn
  svg1.select(".background")
      .datum(d)
    .transition()
      .duration(end);

  d.index = i;
}

function up(d) {
  if (!d.parent || this.__transition__) return;
  var end = duration + d.children.length * delay;

  // Mark any currently-displayed bars as exiting.
  //kbn
  var exit = svg1.selectAll(".enter")
      .attr("class", "exit");

  // Enter the new bars for the clicked-on data's parent.
  var enter = bar(d.parent)
      .attr("transform", function(d, i) { return "translate(0," + barHeight * i * 1.2 + ")"; })
      .style("opacity", 1e-6);

  // Color the bars as appropriate.
  // Exiting nodes will obscure the parent bar, so hide it.
  enter.select("rect")
      .style("fill", function(d) { return color(!!d.children); })
    .filter(function(p) { return p === d; })
      .style("fill-opacity", 1e-6);

  // Update the x-scale domain.
  x.domain([0, d3.max(d.parent.children, function(d) { return d.value; })]).nice();

  // Update the x-axis.
  //kbn
  svg1.selectAll(".x.axis").transition()
      .duration(duration)
      .style("font-size", "15px")
      .call(xAxis);

  // Transition entering bars to fade in over the full duration.
  var enterTransition = enter.transition()
      .duration(end)
      .style("opacity", 1);

  // Transition entering rects to the new x-scale.
  // When the entering parent rect is done, make it visible!
  enterTransition.select("rect")
      .attr("width", function(d) { return x(d.value); })
      .each("end", function(p) { if (p === d) d3.select(this).style("fill-opacity", null); });

  // Transition exiting bars to the parent's position.
  var exitTransition = exit.selectAll("g").transition()
      .duration(duration)
      .delay(function(d, i) { return i * delay; })
      .attr("transform", stack(d.index));

  // Transition exiting text to fade out.
  exitTransition.select("text")
      .style("fill-opacity", 1e-6)
      .style("font-size", "15px");

  // Transition exiting rects to the new scale and fade to parent color.
  exitTransition.select("rect")
      .attr("width", function(d) { return x(d.value); })
      .style("fill", color(true));

  // Remove exiting nodes when the last child has finished transitioning.
  exit.transition()
      .duration(end)
      .remove();

  // Rebind the current parent to the background.
  //kbn
  svg1.select(".background")
      .datum(d.parent)
    .transition()
      .duration(end);
}

// Creates a set of bars for the given data node, at the specified index.
function bar(d) {
  //kbn
  var bar = svg1.insert("g", ".y.axis")
      .attr("class", "enter")
      .attr("transform", "translate(0,5)")
    .selectAll("g")
      .data(d.children)
      .style("font-size", "15px")
    .enter().append("g")
      .style("cursor", function(d) { return !d.children ? null : "pointer"; })
      .on("click", down);

  bar.append("text")
      .attr("x", -6)
      .attr("y", barHeight / 2)
      .attr("dy", ".35em")
      .style("text-anchor", "end")
      .style("font-size", "15px")
      .text(function(d) { return d.name; });

  bar.append("rect")
      .attr("width", function(d) { return x(d.value); })
      .attr("height", barHeight)
      .style("font-size", "15px");

  return bar;
}

// A stateful closure for stacking bars horizontally.
function stack(i) {
  var x0 = 0;
  return function(d) {
    var tx = "translate(" + x0 + "," + barHeight * i * 1.2 + ")";
    x0 += x(d.value);
    return tx;
  };
}})()
      
      
</script>

</body>
<body>

<div class="footer">
          <h2>Copyright</h2>
          <h5>This belongs to IRG4 and IRG4 only. </h5>
</div>
</body>
</html>